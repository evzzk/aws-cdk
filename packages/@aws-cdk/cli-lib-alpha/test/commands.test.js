"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const core = require("aws-cdk-lib/core");
const cli = require("aws-cdk/lib");
const lib_1 = require("../lib");
const commands_1 = require("../lib/commands");
jest.mock('aws-cdk/lib');
jest.mocked(cli.exec).mockResolvedValue(0);
afterEach(() => {
    jest.mocked(cli.exec).mockClear();
});
const cdk = lib_1.AwsCdkCli.fromCloudAssemblyDirectoryProducer({
    produce: async () => {
        const app = new core.App();
        new core.Stack(app, 'Stack1');
        new core.Stack(app, 'Stack2');
        return app.synth().directory;
    },
});
describe('deploy', () => {
    test('default deploy', async () => {
        // WHEN
        await cdk.deploy();
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['deploy', '--progress', 'events', '--all'], expect.anything());
    });
    test('deploy with all arguments', async () => {
        // WHEN
        await cdk.deploy({
            stacks: ['Stack1'],
            ci: false,
            json: true,
            color: false,
            debug: false,
            force: true,
            proxy: 'https://proxy',
            trace: false,
            strict: false,
            execute: true,
            hotswap: commands_1.HotswapMode.HOTSWAP_ONLY,
            lookups: false,
            notices: true,
            profile: 'my-profile',
            roleArn: 'arn:aws:iam::1111111111:role/my-role',
            staging: false,
            verbose: true,
            ec2Creds: true,
            rollback: false,
            exclusively: true,
            outputsFile: 'outputs.json',
            reuseAssets: [
                'asset1234',
                'asset5678',
            ],
            caBundlePath: '/some/path',
            ignoreErrors: false,
            pathMetadata: false,
            assetMetadata: true,
            changeSetName: 'my-change-set',
            requireApproval: commands_1.RequireApproval.NEVER,
            toolkitStackName: 'Toolkit',
            versionReporting: true,
            usePreviousParameters: true,
            progress: commands_1.StackActivityProgress.BAR,
            concurrency: 5,
            assetParallelism: true,
            assetPrebuild: true,
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(expect.arrayContaining([
            'deploy',
            '--no-ci',
            '--execute',
            '--exclusively',
            '--force',
            '--previous-parameters',
            '--no-rollback',
            '--no-staging',
            '--asset-parallelism',
            '--asset-prebuild',
            '--concurrency', '5',
            '--reuse-assets', 'asset1234',
            '--reuse-assets', 'asset5678',
            '--outputs-file', 'outputs.json',
            '--require-approval', 'never',
            '--change-set-name', 'my-change-set',
            '--toolkit-stack-name', 'Toolkit',
            '--progress', 'bar',
            '--no-strict',
            '--no-trace',
            '--no-lookups',
            '--hotswap',
            '--no-ignore-errors',
            '--json',
            '--verbose',
            '--no-debug',
            '--ec2creds',
            '--version-reporting',
            '--no-path-metadata',
            '--asset-metadata',
            '--notices',
            '--no-color',
            '--profile', 'my-profile',
            '--proxy', 'https://proxy',
            '--ca-bundle-path', '/some/path',
            '--role-arn', 'arn:aws:iam::1111111111:role/my-role',
            'Stack1',
        ]), expect.anything());
    });
    test('can parse hotswap-fallback argument', async () => {
        // WHEN
        await cdk.deploy({
            stacks: ['Stack1'],
            hotswap: commands_1.HotswapMode.FALL_BACK,
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith([
            'deploy',
            '--hotswap-fallback',
            '--progress', 'events',
            'Stack1',
        ], expect.anything());
    });
    test('skip hotswap full-deployment argument', async () => {
        // WHEN
        await cdk.deploy({
            stacks: ['Stack1'],
            hotswap: commands_1.HotswapMode.FULL_DEPLOYMENT,
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith([
            'deploy',
            '--progress', 'events',
            'Stack1',
        ], expect.anything());
    });
    test('can parse boolean arguments', async () => {
        // WHEN
        await cdk.deploy({
            stacks: ['Stack1'],
            json: true,
            color: false,
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith([
            'deploy',
            '--progress', 'events',
            '--json',
            '--no-color',
            'Stack1',
        ], expect.anything());
    });
    test('can parse parameters', async () => {
        // WHEN
        await cdk.deploy({
            stacks: ['Stack1'],
            parameters: {
                'myparam': 'test',
                'Stack1:myotherparam': 'test',
            },
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith([
            'deploy',
            '--parameters', 'myparam=test',
            '--parameters', 'Stack1:myotherparam=test',
            '--progress', 'events',
            'Stack1',
        ], expect.anything());
    });
    test('can parse context', async () => {
        // WHEN
        await cdk.deploy({
            stacks: ['Stack1'],
            context: {
                'myContext': 'value',
                'Stack1:OtherContext': 'otherValue',
            },
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith([
            'deploy',
            '--progress', 'events',
            '--context', 'myContext=value',
            '--context', 'Stack1:OtherContext=otherValue',
            'Stack1',
        ], expect.anything());
    });
    test('can parse array arguments', async () => {
        // WHEN
        await cdk.deploy({
            stacks: ['Stack1'],
            notificationArns: [
                'arn:aws:us-east-1:1111111111:some:resource',
                'arn:aws:us-east-1:1111111111:some:other-resource',
            ],
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith([
            'deploy',
            '--notification-arns', 'arn:aws:us-east-1:1111111111:some:resource',
            '--notification-arns', 'arn:aws:us-east-1:1111111111:some:other-resource',
            '--progress', 'events',
            'Stack1',
        ], expect.anything());
    });
    test('can parse number arguments', async () => {
        // WHEN
        await cdk.deploy({
            stacks: ['Stack1'],
            concurrency: 5,
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith([
            'deploy',
            '--concurrency', '5',
            '--progress', 'events',
            'Stack1',
        ], expect.anything());
    });
});
describe('synth', () => {
    test('default synth', async () => {
        // WHEN
        await cdk.synth();
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['synth', '--all'], expect.anything());
    });
    test('synth arguments', async () => {
        // WHEN
        await cdk.synth({
            stacks: ['Stack1'],
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['synth', 'Stack1'], expect.anything());
    });
});
describe('destroy', () => {
    test('default destroy', async () => {
        // WHEN
        await cdk.destroy();
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['destroy', '--force', '--all'], expect.anything());
    });
    test('destroy arguments', async () => {
        // WHEN
        await cdk.destroy({
            stacks: ['Stack1'],
            requireApproval: true,
            exclusively: false,
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['destroy', '--no-exclusively', 'Stack1'], expect.anything());
    });
});
describe('list', () => {
    test('default list', async () => {
        // WHEN
        await cdk.list();
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['ls', '--all'], expect.anything());
    });
    test('list arguments', async () => {
        // WHEN
        await cdk.list({
            stacks: ['*'],
            long: true,
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['ls', '--long', '*'], expect.anything());
    });
    test('list without options', async () => {
        // WHEN
        await cdk.list();
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['ls', '--all'], expect.anything());
    });
    test('bootstrap without options', async () => {
        // WHEN
        await cdk.bootstrap();
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['bootstrap', '--all'], expect.anything());
    });
    test('bootstrap specific environment', async () => {
        // WHEN
        await cdk.bootstrap({
            environments: ['aws://123456789012/us-east-1'],
        });
        // THEN
        expect(jest.mocked(cli.exec)).toHaveBeenCalledWith(['bootstrap', 'aws://123456789012/us-east-1', '--all'], expect.anything());
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbWFuZHMudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNvbW1hbmRzLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx5Q0FBeUM7QUFDekMsbUNBQW1DO0FBQ25DLGdDQUFtQztBQUNuQyw4Q0FBc0Y7QUFFdEYsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztBQUN6QixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUUzQyxTQUFTLENBQUMsR0FBRyxFQUFFO0lBQ2IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7QUFDcEMsQ0FBQyxDQUFDLENBQUM7QUFFSCxNQUFNLEdBQUcsR0FBRyxlQUFTLENBQUMsa0NBQWtDLENBQUM7SUFDdkQsT0FBTyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQ2xCLE1BQU0sR0FBRyxHQUFHLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzNCLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDOUIsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsQ0FBQztRQUU5QixPQUFPLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxTQUFTLENBQUM7SUFDL0IsQ0FBQztDQUNGLENBQUMsQ0FBQztBQUVILFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFO0lBQ3RCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxLQUFLLElBQUksRUFBRTtRQUNoQyxPQUFPO1FBQ1AsTUFBTSxHQUFHLENBQUMsTUFBTSxFQUFFLENBQUM7UUFFbkIsT0FBTztRQUNQLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFD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QUNKLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBjb3JlIGZyb20gJ2F3cy1jZGstbGliL2NvcmUnO1xuaW1wb3J0ICogYXMgY2xpIGZyb20gJ2F3cy1jZGsvbGliJztcbmltcG9ydCB7IEF3c0Nka0NsaSB9IGZyb20gJy4uL2xpYic7XG5pbXBvcnQgeyBIb3Rzd2FwTW9kZSwgUmVxdWlyZUFwcHJvdmFsLCBTdGFja0FjdGl2aXR5UHJvZ3Jlc3MgfSBmcm9tICcuLi9saWIvY29tbWFuZHMnO1xuXG5qZXN0Lm1vY2soJ2F3cy1jZGsvbGliJyk7XG5qZXN0Lm1vY2tlZChjbGkuZXhlYykubW9ja1Jlc29sdmVkVmFsdWUoMCk7XG5cbmFmdGVyRWFjaCgoKSA9PiB7XG4gIGplc3QubW9ja2VkKGNsaS5leGVjKS5tb2NrQ2xlYXIoKTtcbn0pO1xuXG5jb25zdCBjZGsgPSBBd3NDZGtDbGkuZnJvbUNsb3VkQXNzZW1ibHlEaXJlY3RvcnlQcm9kdWNlcih7XG4gIHByb2R1Y2U6IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBhcHAgPSBuZXcgY29yZS5BcHAoKTtcbiAgICBuZXcgY29yZS5TdGFjayhhcHAsICdTdGFjazEnKTtcbiAgICBuZXcgY29yZS5TdGFjayhhcHAsICdTdGFjazInKTtcblxuICAgIHJldHVybiBhcHAuc3ludGgoKS5kaXJlY3Rvcnk7XG4gIH0sXG59KTtcblxuZGVzY3JpYmUoJ2RlcGxveScsICgpID0+IHtcbiAgdGVzdCgnZGVmYXVsdCBkZXBsb3knLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGNkay5kZXBsb3koKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIFsnZGVwbG95JywgJy0tcHJvZ3Jlc3MnLCAnZXZlbnRzJywgJy0tYWxsJ10sXG4gICAgICBleHBlY3QuYW55dGhpbmcoKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdkZXBsb3kgd2l0aCBhbGwgYXJndW1lbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBjZGsuZGVwbG95KHtcbiAgICAgIHN0YWNrczogWydTdGFjazEnXSxcbiAgICAgIGNpOiBmYWxzZSxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBjb2xvcjogZmFsc2UsXG4gICAgICBkZWJ1ZzogZmFsc2UsXG4gICAgICBmb3JjZTogdHJ1ZSxcbiAgICAgIHByb3h5OiAnaHR0cHM6Ly9wcm94eScsXG4gICAgICB0cmFjZTogZmFsc2UsXG4gICAgICBzdHJpY3Q6IGZhbHNlLFxuICAgICAgZXhlY3V0ZTogdHJ1ZSxcbiAgICAgIGhvdHN3YXA6IEhvdHN3YXBNb2RlLkhPVFNXQVBfT05MWSxcbiAgICAgIGxvb2t1cHM6IGZhbHNlLFxuICAgICAgbm90aWNlczogdHJ1ZSxcbiAgICAgIHByb2ZpbGU6ICdteS1wcm9maWxlJyxcbiAgICAgIHJvbGVBcm46ICdhcm46YXdzOmlhbTo6MTExMTExMTExMTpyb2xlL215LXJvbGUnLFxuICAgICAgc3RhZ2luZzogZmFsc2UsXG4gICAgICB2ZXJib3NlOiB0cnVlLFxuICAgICAgZWMyQ3JlZHM6IHRydWUsXG4gICAgICByb2xsYmFjazogZmFsc2UsXG4gICAgICBleGNsdXNpdmVseTogdHJ1ZSxcbiAgICAgIG91dHB1dHNGaWxlOiAnb3V0cHV0cy5qc29uJyxcbiAgICAgIHJldXNlQXNzZXRzOiBbXG4gICAgICAgICdhc3NldDEyMzQnLFxuICAgICAgICAnYXNzZXQ1Njc4JyxcbiAgICAgIF0sXG4gICAgICBjYUJ1bmRsZVBhdGg6ICcvc29tZS9wYXRoJyxcbiAgICAgIGlnbm9yZUVycm9yczogZmFsc2UsXG4gICAgICBwYXRoTWV0YWRhdGE6IGZhbHNlLFxuICAgICAgYXNzZXRNZXRhZGF0YTogdHJ1ZSxcbiAgICAgIGNoYW5nZVNldE5hbWU6ICdteS1jaGFuZ2Utc2V0JyxcbiAgICAgIHJlcXVpcmVBcHByb3ZhbDogUmVxdWlyZUFwcHJvdmFsLk5FVkVSLFxuICAgICAgdG9vbGtpdFN0YWNrTmFtZTogJ1Rvb2xraXQnLFxuICAgICAgdmVyc2lvblJlcG9ydGluZzogdHJ1ZSxcbiAgICAgIHVzZVByZXZpb3VzUGFyYW1ldGVyczogdHJ1ZSxcbiAgICAgIHByb2dyZXNzOiBTdGFja0FjdGl2aXR5UHJvZ3Jlc3MuQkFSLFxuICAgICAgY29uY3VycmVuY3k6IDUsXG4gICAgICBhc3NldFBhcmFsbGVsaXNtOiB0cnVlLFxuICAgICAgYXNzZXRQcmVidWlsZDogdHJ1ZSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIGV4cGVjdC5hcnJheUNvbnRhaW5pbmcoW1xuICAgICAgICAnZGVwbG95JyxcbiAgICAgICAgJy0tbm8tY2knLFxuICAgICAgICAnLS1leGVjdXRlJyxcbiAgICAgICAgJy0tZXhjbHVzaXZlbHknLFxuICAgICAgICAnLS1mb3JjZScsXG4gICAgICAgICctLXByZXZpb3VzLXBhcmFtZXRlcnMnLFxuICAgICAgICAnLS1uby1yb2xsYmFjaycsXG4gICAgICAgICctLW5vLXN0YWdpbmcnLFxuICAgICAgICAnLS1hc3NldC1wYXJhbGxlbGlzbScsXG4gICAgICAgICctLWFzc2V0LXByZWJ1aWxkJyxcbiAgICAgICAgJy0tY29uY3VycmVuY3knLCAnNScsXG4gICAgICAgICctLXJldXNlLWFzc2V0cycsICdhc3NldDEyMzQnLFxuICAgICAgICAnLS1yZXVzZS1hc3NldHMnLCAnYXNzZXQ1Njc4JyxcbiAgICAgICAgJy0tb3V0cHV0cy1maWxlJywgJ291dHB1dHMuanNvbicsXG4gICAgICAgICctLXJlcXVpcmUtYXBwcm92YWwnLCAnbmV2ZXInLFxuICAgICAgICAnLS1jaGFuZ2Utc2V0LW5hbWUnLCAnbXktY2hhbmdlLXNldCcsXG4gICAgICAgICctLXRvb2xraXQtc3RhY2stbmFtZScsICdUb29sa2l0JyxcbiAgICAgICAgJy0tcHJvZ3Jlc3MnLCAnYmFyJyxcbiAgICAgICAgJy0tbm8tc3RyaWN0JyxcbiAgICAgICAgJy0tbm8tdHJhY2UnLFxuICAgICAgICAnLS1uby1sb29rdXBzJyxcbiAgICAgICAgJy0taG90c3dhcCcsXG4gICAgICAgICctLW5vLWlnbm9yZS1lcnJvcnMnLFxuICAgICAgICAnLS1qc29uJyxcbiAgICAgICAgJy0tdmVyYm9zZScsXG4gICAgICAgICctLW5vLWRlYnVnJyxcbiAgICAgICAgJy0tZWMyY3JlZHMnLFxuICAgICAgICAnLS12ZXJzaW9uLXJlcG9ydGluZycsXG4gICAgICAgICctLW5vLXBhdGgtbWV0YWRhdGEnLFxuICAgICAgICAnLS1hc3NldC1tZXRhZGF0YScsXG4gICAgICAgICctLW5vdGljZXMnLFxuICAgICAgICAnLS1uby1jb2xvcicsXG4gICAgICAgICctLXByb2ZpbGUnLCAnbXktcHJvZmlsZScsXG4gICAgICAgICctLXByb3h5JywgJ2h0dHBzOi8vcHJveHknLFxuICAgICAgICAnLS1jYS1idW5kbGUtcGF0aCcsICcvc29tZS9wYXRoJyxcbiAgICAgICAgJy0tcm9sZS1hcm4nLCAnYXJuOmF3czppYW06OjExMTExMTExMTE6cm9sZS9teS1yb2xlJyxcbiAgICAgICAgJ1N0YWNrMScsXG4gICAgICBdKSxcbiAgICAgIGV4cGVjdC5hbnl0aGluZygpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBwYXJzZSBob3Rzd2FwLWZhbGxiYWNrIGFyZ3VtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBjZGsuZGVwbG95KHtcbiAgICAgIHN0YWNrczogWydTdGFjazEnXSxcbiAgICAgIGhvdHN3YXA6IEhvdHN3YXBNb2RlLkZBTExfQkFDSyxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIFtcbiAgICAgICAgJ2RlcGxveScsXG4gICAgICAgICctLWhvdHN3YXAtZmFsbGJhY2snLFxuICAgICAgICAnLS1wcm9ncmVzcycsICdldmVudHMnLFxuICAgICAgICAnU3RhY2sxJyxcbiAgICAgIF0sXG4gICAgICBleHBlY3QuYW55dGhpbmcoKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdza2lwIGhvdHN3YXAgZnVsbC1kZXBsb3ltZW50IGFyZ3VtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBjZGsuZGVwbG95KHtcbiAgICAgIHN0YWNrczogWydTdGFjazEnXSxcbiAgICAgIGhvdHN3YXA6IEhvdHN3YXBNb2RlLkZVTExfREVQTE9ZTUVOVCxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIFtcbiAgICAgICAgJ2RlcGxveScsXG4gICAgICAgICctLXByb2dyZXNzJywgJ2V2ZW50cycsXG4gICAgICAgICdTdGFjazEnLFxuICAgICAgXSxcbiAgICAgIGV4cGVjdC5hbnl0aGluZygpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBwYXJzZSBib29sZWFuIGFyZ3VtZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgYXdhaXQgY2RrLmRlcGxveSh7XG4gICAgICBzdGFja3M6IFsnU3RhY2sxJ10sXG4gICAgICBqc29uOiB0cnVlLFxuICAgICAgY29sb3I6IGZhbHNlLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChqZXN0Lm1vY2tlZChjbGkuZXhlYykpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgW1xuICAgICAgICAnZGVwbG95JyxcbiAgICAgICAgJy0tcHJvZ3Jlc3MnLCAnZXZlbnRzJyxcbiAgICAgICAgJy0tanNvbicsXG4gICAgICAgICctLW5vLWNvbG9yJyxcbiAgICAgICAgJ1N0YWNrMScsXG4gICAgICBdLFxuICAgICAgZXhwZWN0LmFueXRoaW5nKCksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIHBhcnNlIHBhcmFtZXRlcnMnLCBhc3luYygpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgYXdhaXQgY2RrLmRlcGxveSh7XG4gICAgICBzdGFja3M6IFsnU3RhY2sxJ10sXG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICdteXBhcmFtJzogJ3Rlc3QnLFxuICAgICAgICAnU3RhY2sxOm15b3RoZXJwYXJhbSc6ICd0ZXN0JyxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KGplc3QubW9ja2VkKGNsaS5leGVjKSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICBbXG4gICAgICAgICdkZXBsb3knLFxuICAgICAgICAnLS1wYXJhbWV0ZXJzJywgJ215cGFyYW09dGVzdCcsXG4gICAgICAgICctLXBhcmFtZXRlcnMnLCAnU3RhY2sxOm15b3RoZXJwYXJhbT10ZXN0JyxcbiAgICAgICAgJy0tcHJvZ3Jlc3MnLCAnZXZlbnRzJyxcbiAgICAgICAgJ1N0YWNrMScsXG4gICAgICBdLFxuICAgICAgZXhwZWN0LmFueXRoaW5nKCksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIHBhcnNlIGNvbnRleHQnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGNkay5kZXBsb3koe1xuICAgICAgc3RhY2tzOiBbJ1N0YWNrMSddLFxuICAgICAgY29udGV4dDoge1xuICAgICAgICAnbXlDb250ZXh0JzogJ3ZhbHVlJyxcbiAgICAgICAgJ1N0YWNrMTpPdGhlckNvbnRleHQnOiAnb3RoZXJWYWx1ZScsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChqZXN0Lm1vY2tlZChjbGkuZXhlYykpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgW1xuICAgICAgICAnZGVwbG95JyxcbiAgICAgICAgJy0tcHJvZ3Jlc3MnLCAnZXZlbnRzJyxcbiAgICAgICAgJy0tY29udGV4dCcsICdteUNvbnRleHQ9dmFsdWUnLFxuICAgICAgICAnLS1jb250ZXh0JywgJ1N0YWNrMTpPdGhlckNvbnRleHQ9b3RoZXJWYWx1ZScsXG4gICAgICAgICdTdGFjazEnLFxuICAgICAgXSxcbiAgICAgIGV4cGVjdC5hbnl0aGluZygpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBwYXJzZSBhcnJheSBhcmd1bWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGNkay5kZXBsb3koe1xuICAgICAgc3RhY2tzOiBbJ1N0YWNrMSddLFxuICAgICAgbm90aWZpY2F0aW9uQXJuczogW1xuICAgICAgICAnYXJuOmF3czp1cy1lYXN0LTE6MTExMTExMTExMTpzb21lOnJlc291cmNlJyxcbiAgICAgICAgJ2Fybjphd3M6dXMtZWFzdC0xOjExMTExMTExMTE6c29tZTpvdGhlci1yZXNvdXJjZScsXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChqZXN0Lm1vY2tlZChjbGkuZXhlYykpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgW1xuICAgICAgICAnZGVwbG95JyxcbiAgICAgICAgJy0tbm90aWZpY2F0aW9uLWFybnMnLCAnYXJuOmF3czp1cy1lYXN0LTE6MTExMTExMTExMTpzb21lOnJlc291cmNlJyxcbiAgICAgICAgJy0tbm90aWZpY2F0aW9uLWFybnMnLCAnYXJuOmF3czp1cy1lYXN0LTE6MTExMTExMTExMTpzb21lOm90aGVyLXJlc291cmNlJyxcbiAgICAgICAgJy0tcHJvZ3Jlc3MnLCAnZXZlbnRzJyxcbiAgICAgICAgJ1N0YWNrMScsXG4gICAgICBdLFxuICAgICAgZXhwZWN0LmFueXRoaW5nKCksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIHBhcnNlIG51bWJlciBhcmd1bWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGNkay5kZXBsb3koe1xuICAgICAgc3RhY2tzOiBbJ1N0YWNrMSddLFxuICAgICAgY29uY3VycmVuY3k6IDUsXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KGplc3QubW9ja2VkKGNsaS5leGVjKSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICBbXG4gICAgICAgICdkZXBsb3knLFxuICAgICAgICAnLS1jb25jdXJyZW5jeScsICc1JyxcbiAgICAgICAgJy0tcHJvZ3Jlc3MnLCAnZXZlbnRzJyxcbiAgICAgICAgJ1N0YWNrMScsXG4gICAgICBdLFxuICAgICAgZXhwZWN0LmFueXRoaW5nKCksXG4gICAgKTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ3N5bnRoJywgKCkgPT4ge1xuICB0ZXN0KCdkZWZhdWx0IHN5bnRoJywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBjZGsuc3ludGgoKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIFsnc3ludGgnLCAnLS1hbGwnXSxcbiAgICAgIGV4cGVjdC5hbnl0aGluZygpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ3N5bnRoIGFyZ3VtZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgYXdhaXQgY2RrLnN5bnRoKHtcbiAgICAgIHN0YWNrczogWydTdGFjazEnXSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIFsnc3ludGgnLCAnU3RhY2sxJ10sXG4gICAgICBleHBlY3QuYW55dGhpbmcoKSxcbiAgICApO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnZGVzdHJveScsICgpID0+IHtcbiAgdGVzdCgnZGVmYXVsdCBkZXN0cm95JywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBjZGsuZGVzdHJveSgpO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChqZXN0Lm1vY2tlZChjbGkuZXhlYykpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgWydkZXN0cm95JywgJy0tZm9yY2UnLCAnLS1hbGwnXSxcbiAgICAgIGV4cGVjdC5hbnl0aGluZygpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2Rlc3Ryb3kgYXJndW1lbnRzJywgYXN5bmMgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBhd2FpdCBjZGsuZGVzdHJveSh7XG4gICAgICBzdGFja3M6IFsnU3RhY2sxJ10sXG4gICAgICByZXF1aXJlQXBwcm92YWw6IHRydWUsXG4gICAgICBleGNsdXNpdmVseTogZmFsc2UsXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KGplc3QubW9ja2VkKGNsaS5leGVjKSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICBbJ2Rlc3Ryb3knLCAnLS1uby1leGNsdXNpdmVseScsICdTdGFjazEnXSxcbiAgICAgIGV4cGVjdC5hbnl0aGluZygpLFxuICAgICk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdsaXN0JywgKCkgPT4ge1xuICB0ZXN0KCdkZWZhdWx0IGxpc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGNkay5saXN0KCk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KGplc3QubW9ja2VkKGNsaS5leGVjKSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICBbJ2xzJywgJy0tYWxsJ10sXG4gICAgICBleHBlY3QuYW55dGhpbmcoKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdsaXN0IGFyZ3VtZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgYXdhaXQgY2RrLmxpc3Qoe1xuICAgICAgc3RhY2tzOiBbJyonXSxcbiAgICAgIGxvbmc6IHRydWUsXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KGplc3QubW9ja2VkKGNsaS5leGVjKSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICBbJ2xzJywgJy0tbG9uZycsICcqJ10sXG4gICAgICBleHBlY3QuYW55dGhpbmcoKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdsaXN0IHdpdGhvdXQgb3B0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgYXdhaXQgY2RrLmxpc3QoKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIFsnbHMnLCAnLS1hbGwnXSxcbiAgICAgIGV4cGVjdC5hbnl0aGluZygpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2Jvb3RzdHJhcCB3aXRob3V0IG9wdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGNkay5ib290c3RyYXAoKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIFsnYm9vdHN0cmFwJywgJy0tYWxsJ10sXG4gICAgICBleHBlY3QuYW55dGhpbmcoKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdib290c3RyYXAgc3BlY2lmaWMgZW52aXJvbm1lbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGF3YWl0IGNkay5ib290c3RyYXAoe1xuICAgICAgZW52aXJvbm1lbnRzOiBbJ2F3czovLzEyMzQ1Njc4OTAxMi91cy1lYXN0LTEnXSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoamVzdC5tb2NrZWQoY2xpLmV4ZWMpKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgIFsnYm9vdHN0cmFwJywgJ2F3czovLzEyMzQ1Njc4OTAxMi91cy1lYXN0LTEnLCAnLS1hbGwnXSxcbiAgICAgIGV4cGVjdC5hbnl0aGluZygpLFxuICAgICk7XG4gIH0pO1xufSk7XG4iXX0=